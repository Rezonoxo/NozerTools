
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydroTrack - Hydration Tracking</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2980b9;
            --accent: #1abc9c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --gray: #95a5a6;
            --white: #ffffff;
            --shadow: rgba(0, 0, 0, 0.1);
            --glass: rgba(255, 255, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #c2e9fb 0%, #a1c4fd 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 30px var(--shadow);
            overflow: hidden;
            margin: 20px 0;
        }

        header {
            background: var(--primary);
            color: var(--white);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
        }

        .logo i {
            font-size: 28px;
        }

        nav {
            display: flex;
            background: var(--secondary);
            padding: 0;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--white);
            font-weight: 500;
            border-bottom: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-item.active {
            border-bottom: 3px solid var(--accent);
            background: rgba(255, 255, 255, 0.15);
        }

        .section {
            display: none;
            padding: 30px;
            min-height: 500px;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Dashboard */
        .dashboard {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .progress-container {
            position: relative;
            width: 250px;
            height: 250px;
        }

        .progress-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(var(--primary) 0%, var(--light) 0%);
            transition: all 0.5s ease;
        }

        .progress-inner {
            position: absolute;
            top: 15px;
            left: 15px;
            width: calc(100% - 30px);
            height: calc(100% - 30px);
            background: var(--white);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .progress-value {
            font-size: 48px;
            font-weight: bold;
            color: var(--primary);
        }

        .progress-target {
            font-size: 16px;
            color: var(--gray);
        }

        .water-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            width: 100%;
            max-width: 400px;
        }

        .water-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: var(--primary);
            color: var(--white);
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .water-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px var(--shadow);
        }

        .water-btn.custom {
            background: var(--accent);
            grid-column: span 2;
        }

        .water-btn i {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .hydration-log {
            width: 100%;
            max-width: 600px;
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .log-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .log-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .log-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--light);
        }

        .log-item:last-child {
            border-bottom: none;
        }

        /* Fact popup */
        .fact-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 25px var(--shadow);
            max-width: 350px;
            z-index: 100;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .fact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .fact-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--gray);
        }

        .fact-content {
            font-size: 16px;
            line-height: 1.5;
        }

        /* Notifications section */
        .reminder-form {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
            margin-bottom: 30px;
        }

        .form-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light);
            border-radius: 8px;
            font-size: 16px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: var(--primary);
            color: var(--white);
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--secondary);
        }

        .reminder-list {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
        }

        /* Statistics section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
            text-align: center;
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }

        .stat-label {
            font-size: 16px;
            color: var(--gray);
        }

        .chart-container {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
            margin-bottom: 30px;
            height: 300px;
        }

        /* Help section */
        .faq-list {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
            margin-bottom: 30px;
        }

        .faq-item {
            margin-bottom: 15px;
            border-bottom: 1px solid var(--light);
            padding-bottom: 15px;
        }

        .faq-question {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--dark);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: color 0.3s ease;
            user-select: none;
        }

        .faq-question:hover {
            color: var(--primary);
        }

        .faq-question i {
            transition: transform 0.3s ease;
            color: var(--primary);
        }

        .faq-question.active i {
            transform: rotate(180deg);
        }

        .faq-answer {
            font-size: 16px;
            line-height: 1.5;
            color: var(--dark);
            padding-top: 10px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding-top 0.3s ease;
        }

        .faq-answer.active {
            max-height: 200px;
            padding-top: 10px;
        }

        .contact-info {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px var(--shadow);
        }

        /* Goal setting modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px var(--shadow);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            padding: 5px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .modal-close:hover {
            background: var(--light);
        }

        .goal-tabs {
            display: flex;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            background: var(--light);
        }

        .goal-tab {
            flex: 1;
            padding: 12px;
            background: var(--light);
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .goal-tab.active {
            background: var(--primary);
            color: var(--white);
        }

        .goal-form {
            display: none;
        }

        .goal-form.active {
            display: block;
        }

        .goal-form h4 {
            margin-bottom: 15px;
            color: var(--dark);
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .calculate-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: var(--accent);
            color: var(--white);
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .calculate-btn:hover {
            background: #17a085;
            transform: translateY(-2px);
        }

        .result-display {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            color: var(--dark);
        }

        .progress-target {
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .progress-target:hover {
            color: var(--primary);
        }

        /* Global error/success messages */
        .global-error {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--danger);
            color: var(--white);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px var(--shadow);
            z-index: 1000;
            display: none;
            max-width: 400px;
            text-align: center;
        }

        .global-error.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .global-success {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: var(--white);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px var(--shadow);
            z-index: 1000;
            display: none;
            max-width: 400px;
            text-align: center;
        }

        .global-success.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(-20px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        /* Responsiveness */
        @media (max-width: 768px) {
            .water-buttons {
                grid-template-columns: 1fr;
            }
            
            .water-btn.custom {
                grid-column: span 1;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            nav {
                flex-wrap: wrap;
            }
            
            .nav-item {
                flex: 1 0 50%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-tint"></i>
                <span>HydroTrack</span>
            </div>
        </header>
        
        <nav>
            <div class="nav-item active" data-target="dashboard">
                <i class="fas fa-home"></i> Dashboard
            </div>
            <div class="nav-item" data-target="notifications">
                <i class="fas fa-bell"></i> Reminders
            </div>
            <div class="nav-item" data-target="statistics">
                <i class="fas fa-chart-bar"></i> Statistics
            </div>
            <div class="nav-item" data-target="help">
                <i class="fas fa-question-circle"></i> Help
            </div>
        </nav>
        
        <!-- Dashboard section -->
        <section id="dashboard" class="section active">
            <div class="dashboard">
                <div class="progress-container">
                    <div class="progress-circle" id="progress-circle"></div>
                    <div class="progress-inner">
                        <div class="progress-value" id="progress-value">0%</div>
                        <div class="progress-target" id="progress-target">0 / 2000 ml</div>
                    </div>
                </div>
                
                <div class="water-buttons">
                    <button class="water-btn" data-amount="150">
                        <i class="fas fa-glass"></i>
                        150 ml
                    </button>
                    <button class="water-btn" data-amount="250">
                        <i class="fas fa-glass"></i>
                        250 ml
                    </button>
                    <button class="water-btn" data-amount="500">
                        <i class="fas fa-glass"></i>
                        500 ml
                    </button>
                    <button class="water-btn custom" id="custom-water">
                        <i class="fas fa-pen"></i>
                        Custom Amount
                    </button>
                </div>
                
                <div class="hydration-log">
                    <h3 class="log-title"><i class="fas fa-history"></i> Recent Hydrations</h3>
                    <div class="log-list" id="hydration-log">
                        <!-- Entries will be added here -->
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Notifications section -->
        <section id="notifications" class="section">
            <h2 class="form-title"><i class="fas fa-bell"></i> Reminder Settings</h2>
            
            <div class="reminder-form">
                <h3 class="form-title">Add a Reminder</h3>
                <div class="form-group">
                    <label for="reminder-type">Reminder Type</label>
                    <select id="reminder-type">
                        <option value="interval">At regular intervals</option>
                        <option value="specific">At specific time</option>
                    </select>
                </div>
                
                <div class="form-group" id="interval-group">
                    <label for="reminder-interval">Interval (minutes)</label>
                    <input type="number" id="reminder-interval" min="5" value="30">
                </div>
                
                <div class="form-group" id="time-group" style="display: none;">
                    <label for="reminder-time">Time</label>
                    <input type="time" id="reminder-time">
                </div>
                
                <button class="btn" id="add-reminder">Add Reminder</button>
                <button class="btn" id="test-notification" style="background: var(--accent); margin-top: 10px;">Test Notification</button>
            </div>
            
            <div class="reminder-list">
                <h3 class="form-title">Active Reminders</h3>
                <div id="reminders-list">
                    <!-- Reminders will be added here -->
                </div>
            </div>
        </section>
        
        <!-- Statistics section -->
        <section id="statistics" class="section">
            <h2 class="form-title"><i class="fas fa-chart-bar"></i> Hydration Statistics</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Today's Hydration</div>
                    <div class="stat-value" id="stat-today">0 ml</div>
                    <div class="stat-label" id="stat-today-percent">0% of goal</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">Daily Average</div>
                    <div class="stat-value" id="stat-average">0 ml</div>
                    <div class="stat-label">from last 7 days</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">Goal Achieved Days</div>
                    <div class="stat-value" id="stat-goal-days">0</div>
                    <div class="stat-label">this month</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">Current Streak</div>
                    <div class="stat-value" id="stat-streak">0 days</div>
                    <div class="stat-label">consecutive days with goal</div>
                </div>
            </div>
            
            <div class="chart-container">
                <h3 class="form-title">Hydration This Week</h3>
                <canvas id="weekly-chart"></canvas>
            </div>
        </section>
        
        <!-- Help section -->
        <section id="help" class="section">
            <h2 class="form-title"><i class="fas fa-question-circle"></i> Help Center</h2>
            
            <div class="faq-list">
                <h3 class="form-title">Frequently Asked Questions</h3>
                
                <div class="faq-item">
                    <div class="faq-question">
                        How to set a daily hydration goal?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        To set a daily goal, go to the dashboard section and click on the goal value. You can set the goal manually or calculate it based on your weight and activity level.
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        How to add a custom amount of water?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        Click the "Custom Amount" button on the dashboard, then enter the desired amount of water in milliliters.
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        How do reminders work?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        In the Reminders section, you can set up drinking water reminders. You can choose notifications at regular intervals (e.g. every 30 minutes) or at specific times.
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        What does "Data will be saved locally" mean?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        This means your data is safely stored in your browser and will be available the next time you open the application. You can still use all the application features.
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        How does offline mode work?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        In offline mode, all your data is stored locally in your browser. You can use all application features, including adding water, setting reminders, and viewing statistics. Data will be available even without an internet connection.
                    </div>
                </div>
            </div>
            
            <div class="contact-info">
                <h3 class="form-title">Contact</h3>
                <p>Have questions or issues? Contact us:</p>
                <p>Email: support@hydrotrack.com</p>
                <p>Website: www.hydrotrack.com</p>
            </div>
        </section>
    </div>
    
    <!-- Global messages -->
    <div class="global-error" id="global-error"></div>
    <div class="global-success" id="global-success"></div>
    
    <!-- Goal setting modal -->
    <div class="modal-overlay" id="goal-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-bullseye"></i>
                    Set Daily Hydration Goal
                </div>
                <button class="modal-close" id="close-goal-modal">&times;</button>
            </div>
            
            <div class="goal-tabs">
                <button class="goal-tab active" data-form="manual">Manual</button>
                <button class="goal-tab" data-form="calculate">Calculate</button>
            </div>
            
            <!-- Manual goal setting form -->
            <div class="goal-form active" id="manual-form">
                <h4>Set Goal Manually</h4>
                <div class="form-group">
                    <label for="manual-goal">Daily Goal (ml)</label>
                    <input type="number" id="manual-goal" min="500" max="5000" value="2000">
                </div>
                <button class="btn" id="set-manual-goal">Set Goal</button>
            </div>
            
            <!-- Calculation form -->
            <div class="goal-form" id="calculate-form">
                <h4>Calculate Goal Based on Your Data</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label for="weight">Weight (kg)</label>
                        <input type="number" id="weight" min="30" max="200" placeholder="70">
                    </div>
                    <div class="form-group">
                        <label for="age">Age</label>
                        <input type="number" id="age" min="1" max="120" placeholder="25">
                    </div>
                </div>
                <div class="form-group">
                    <label for="activity-level">Activity Level</label>
                    <select id="activity-level">
                        <option value="low">Low (sedentary lifestyle)</option>
                        <option value="moderate" selected>Moderate (light activity)</option>
                        <option value="high">High (intense workouts)</option>
                        <option value="very-high">Very high (professional athlete)</option>
                    </select>
                </div>
                <button class="calculate-btn" id="calculate-goal">
                    <i class="fas fa-calculator"></i> Calculate Goal
                </button>
                <div class="result-display" id="calculation-result" style="display: none;">
                    <div id="calculated-amount">0 ml</div>
                    <div style="font-size: 14px; color: var(--gray); margin-top: 5px;">
                        Recommended daily water amount
                    </div>
                </div>
                <button class="btn" id="set-calculated-goal" style="display: none;">Set Calculated Goal</button>
            </div>
        </div>
    </div>
    
    <!-- Fact popup -->
    <div class="fact-popup" id="fact-popup">
        <div class="fact-header">
            <div class="fact-title">
                <i class="fas fa-lightbulb"></i>
                Did You Know?
            </div>
            <button class="close-btn" id="close-fact">&times;</button>
        </div>
        <div class="fact-content" id="fact-content">
            Water makes up about 60% of an adult's body weight and is essential for the proper functioning of the body.
        </div>
    </div>

    <script>
        // App data
        let waterData = {
            current: 0,
            target: 2000,
            history: [],
            reminders: [],
            goalAchieved: 0,
            streak: 0,
            lastResetDate: new Date().toDateString()
        };
        
        // Water facts
        const waterFacts = [
            "Water makes up about 60% of an adult's body weight and is essential for the proper functioning of the body.",
            "Even mild dehydration can affect mood, concentration, and physical performance.",
            "An adult loses about 2-3 liters of water daily through breathing, sweating, and other bodily functions.",
            "Drinking water can boost metabolism by up to 30% within 30-40 minutes.",
            "Optimal hydration improves skin elasticity and delays the appearance of wrinkles.",
            "Water helps remove toxins from the body and supports kidney function.",
            "Dehydration can cause headaches and migraines.",
            "Drinking water before meals can help with weight loss by reducing appetite."
        ];
        
        // Initialize after DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            // Check if we need to reset the daily counter
            checkAndResetDailyCounter();
            
            // Load data from localStorage
            loadData();
            
            // Navigation
            setupNavigation();
            
            // Water buttons
            setupWaterButtons();
            
            // Reminders
            setupReminders();
            
            // Initialize chart
            initChart();
            
            // Show random fact
            showRandomFact();
            
            // FAQ
            setupFAQ();
            
            // Goal modal
            setupGoalModal();
            
            // Update UI
            updateUI();
        });
        
        // Function to check and reset daily counter if needed
        function checkAndResetDailyCounter() {
            const today = new Date().toDateString();
            const savedData = localStorage.getItem('hydrotrack_data');
            
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                
                // If the last reset date is different from today, reset current water intake
                if (parsedData.lastResetDate !== today) {
                    parsedData.current = 0;
                    parsedData.lastResetDate = today;
                    
                    // Update streak if goal was achieved yesterday
                    if (parsedData.current >= parsedData.target) {
                        parsedData.streak++;
                    } else {
                        parsedData.streak = 0;
                    }
                    
                    // Save the updated data
                    localStorage.setItem('hydrotrack_data', JSON.stringify(parsedData));
                    
                    // Show notification about reset
                    showGlobalSuccess("Daily counter has been reset. Let's hydrate today!", 5000);
                }
            }
        }
        
        // Function to load data
        function loadData() {
            const savedData = localStorage.getItem('hydrotrack_data');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                
                // Check if we need to reset the counter
                const today = new Date().toDateString();
                if (parsedData.lastResetDate !== today) {
                    parsedData.current = 0;
                    parsedData.lastResetDate = today;
                }
                
                waterData = parsedData;
            } else {
                // Initialize with default values
                saveData();
            }
        }
        
        // Function to save data
        function saveData() {
            localStorage.setItem('hydrotrack_data', JSON.stringify(waterData));
        }
        
        // Navigation function
        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    
                    // Remove active class from all items
                    navItems.forEach(navItem => {
                        navItem.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Hide all sections
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show target section
                    document.getElementById(target).classList.add('active');
                });
            });
        }
        
        // Water buttons function
        function setupWaterButtons() {
            const waterButtons = document.querySelectorAll('.water-btn');
            
            waterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    if (this.id === 'custom-water') {
                        const amount = prompt('Enter water amount in ml:');
                        if (amount && !isNaN(amount) && amount > 0) {
                            addWater(parseInt(amount));
                        }
                    } else {
                        const amount = parseInt(this.getAttribute('data-amount'));
                        addWater(amount);
                    }
                });
            });
        }
        
        // Add water function
        function addWater(amount) {
            try {
                waterData.current += amount;
                
                // Add to history
                const now = new Date();
                waterData.history.unshift({
                    amount: amount,
                    timestamp: now.toISOString(),
                    time: now.toLocaleTimeString()
                });
                
                // Limit history to 50 entries
                if (waterData.history.length > 50) {
                    waterData.history = waterData.history.slice(0, 50);
                }
                
                // Check if goal was achieved
                if (waterData.current >= waterData.target && waterData.current - amount < waterData.target) {
                    waterData.goalAchieved++;
                    waterData.streak++;
                    
                    // Show goal achievement notification
                    showGlobalSuccess('Congratulations! You reached your daily hydration goal! ðŸŽ‰');
                }
                
                // Save data and update UI
                saveData();
                updateUI();
                
                showGlobalSuccess(`Added ${amount} ml of water!`);
                
            } catch (error) {
                handleError(error, 'Adding water');
            }
        }
        
        // Update UI function
        function updateUI() {
            // Update progress circle
            const progress = Math.min(100, (waterData.current / waterData.target) * 100);
            document.getElementById('progress-circle').style.background = 
                `conic-gradient(var(--primary) ${progress}%, var(--light) 0%)`;
            
            document.getElementById('progress-value').textContent = `${Math.round(progress)}%`;
            document.getElementById('progress-target').textContent = `${waterData.current} / ${waterData.target} ml`;
            
            // Update hydration history
            const logList = document.getElementById('hydration-log');
            logList.innerHTML = '';
            
            waterData.history.slice(0, 10).forEach(entry => {
                const logItem = document.createElement('div');
                logItem.className = 'log-item';
                logItem.innerHTML = `
                    <span>${entry.amount} ml</span>
                    <span>${entry.time}</span>
                `;
                logList.appendChild(logItem);
            });
            
            // Update statistics
            updateStatistics();
        }
        
        // Update statistics function
        function updateStatistics() {
            document.getElementById('stat-today').textContent = `${waterData.current} ml`;
            document.getElementById('stat-today-percent').textContent = 
                `${Math.round((waterData.current / waterData.target) * 100)}% of goal`;
            
            // Simplified statistics calculation
            document.getElementById('stat-average').textContent = `${Math.round(waterData.current * 0.85)} ml`;
            document.getElementById('stat-goal-days').textContent = waterData.goalAchieved;
            document.getElementById('stat-streak').textContent = `${waterData.streak} days`;
        }
        
        // Reminders function
        function setupReminders() {
            const reminderType = document.getElementById('reminder-type');
            const intervalGroup = document.getElementById('interval-group');
            const timeGroup = document.getElementById('time-group');
            
            reminderType.addEventListener('change', function() {
                if (this.value === 'interval') {
                    intervalGroup.style.display = 'block';
                    timeGroup.style.display = 'none';
                } else {
                    intervalGroup.style.display = 'none';
                    timeGroup.style.display = 'block';
                }
            });
            
            document.getElementById('add-reminder').addEventListener('click', async function() {
                try {
                    const type = document.getElementById('reminder-type').value;
                    let value;
                    
                    if (type === 'interval') {
                        value = document.getElementById('reminder-interval').value;
                    } else {
                        value = document.getElementById('reminder-time').value;
                    }
                    
                    // Check notification permissions
                    const hasPermission = await requestNotificationPermission();
                    if (!hasPermission) {
                        handleError('No notification permissions. Check your browser settings.');
                        return;
                    }
                    
                    // Clear existing reminders
                    clearNotificationReminders();
                    
                    // Add new reminder
                    waterData.reminders.push({ type, value });
                    
                    // Set up new notifications
                    setupNotificationReminders();
                    
                    saveData();
                    updateRemindersList();
                    
                    showGlobalSuccess('Reminder added successfully!');
                    
                } catch (error) {
                    handleError(error, 'Adding reminder');
                }
            });
            
            // Test notification button
            document.getElementById('test-notification').addEventListener('click', async function() {
                try {
                    const hasPermission = await requestNotificationPermission();
                    if (!hasPermission) {
                        handleError('No notification permissions. Check your browser settings.');
                        return;
                    }
                    
                    showNotification('HydroTrack - Test', {
                        body: 'This is a test notification! ðŸ’§',
                        tag: 'test-notification'
                    });
                    
                    showGlobalSuccess('Test notification sent!');
                    
                } catch (error) {
                    handleError(error, 'Testing notifications');
                }
            });
        }
        
        // Update reminders list function
        function updateRemindersList() {
            const remindersList = document.getElementById('reminders-list');
            remindersList.innerHTML = '';
            
            waterData.reminders.forEach((reminder, index) => {
                const reminderItem = document.createElement('div');
                reminderItem.className = 'log-item';
                
                let text;
                if (reminder.type === 'interval') {
                    text = `Every ${reminder.value} minutes`;
                } else {
                    text = `At ${reminder.value}`;
                }
                
                reminderItem.innerHTML = `
                    <span>${text}</span>
                    <span>
                        <button class="btn" data-index="${index}">Remove</button>
                    </span>
                `;
                
                remindersList.appendChild(reminderItem);
            });
            
            // Add remove button functionality
            document.querySelectorAll('#reminders-list .btn').forEach(button => {
                button.addEventListener('click', function() {
                    try {
                        const index = parseInt(this.getAttribute('data-index'));
                        
                        // Clear notifications for this reminder
                        if (waterData.reminders[index].intervalId) {
                            clearInterval(waterData.reminders[index].intervalId);
                        }
                        if (waterData.reminders[index].timeoutId) {
                            clearTimeout(waterData.reminders[index].timeoutId);
                        }
                        
                        waterData.reminders.splice(index, 1);
                        saveData();
                        updateRemindersList();
                        
                        showGlobalSuccess('Reminder removed successfully!');
                        
                    } catch (error) {
                        handleError(error, 'Removing reminder');
                    }
                });
            });
        }
        
        // Initialize chart function
        function initChart() {
            const ctx = document.getElementById('weekly-chart').getContext('2d');
            
            // Simplified chart implementation
            ctx.font = '16px Arial';
            ctx.fillStyle = '#3498db';
            ctx.fillText('Weekly Hydration Chart', 50, 150);
            ctx.fillText('Your statistics will appear here', 60, 180);
        }
        
        // Show random fact function
        function showRandomFact() {
            const randomIndex = Math.floor(Math.random() * waterFacts.length);
            document.getElementById('fact-content').textContent = waterFacts[randomIndex];
            
            document.getElementById('close-fact').addEventListener('click', function() {
                document.getElementById('fact-popup').style.display = 'none';
            });
        }
        
        // Global error handling functions
        function showGlobalError(message, duration = 5000) {
            const errorElement = document.getElementById('global-error');
            errorElement.textContent = message;
            errorElement.classList.add('active');
            
            setTimeout(() => {
                errorElement.classList.remove('active');
            }, duration);
        }
        
        function showGlobalSuccess(message, duration = 3000) {
            const successElement = document.getElementById('global-success');
            successElement.textContent = message;
            successElement.classList.add('active');
            
            setTimeout(() => {
                successElement.classList.remove('active');
            }, duration);
        }
        
        function handleError(error, context = '') {
            console.error(`Error ${context}:`, error);
            
            let errorMessage = 'An unexpected error occurred';
            
            if (error.message) {
                errorMessage = error.message;
            } else if (typeof error === 'string') {
                errorMessage = error;
            }
            
            if (context) {
                errorMessage = `${context}: ${errorMessage}`;
            }
            
            showGlobalError(errorMessage);
        }
        
        // Browser notification functions
        async function requestNotificationPermission() {
            if ('Notification' in window) {
                const permission = await Notification.requestPermission();
                return permission === 'granted';
            }
            return false;
        }
        
        function showNotification(title, options = {}) {
            if ('Notification' in window && Notification.permission === 'granted') {
                const notification = new Notification(title, {
                    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiIGZpbGw9IiMzNDk4ZGIiLz4KPHBhdGggZD0iTTI0IDI4SDQwVjM2SDI0VjI4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTI4IDMySDM2VjQwSDI4VjMyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+',
                    badge: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiIGZpbGw9IiMyN2FlNjAiLz4KPC9zdmc+',
                    ...options
                });
                
                // Auto-close notification after 5 seconds
                setTimeout(() => {
                    notification.close();
                }, 5000);
                
                return notification;
            }
            return null;
        }
        
        function setupNotificationReminders() {
            waterData.reminders.forEach(reminder => {
                if (reminder.type === 'interval') {
                    const interval = parseInt(reminder.value) * 60 * 1000; // Convert to milliseconds
                    const reminderId = setInterval(() => {
                        showNotification('HydroTrack - Reminder', {
                            body: 'Time for a glass of water! ðŸ’§',
                            tag: 'water-reminder'
                        });
                    }, interval);
                    
                    // Save interval ID to reminder
                    reminder.intervalId = reminderId;
                } else if (reminder.type === 'specific') {
                    const [hours, minutes] = reminder.value.split(':');
                    const now = new Date();
                    const reminderTime = new Date();
                    reminderTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                    
                    // If time has already passed today, set for tomorrow
                    if (reminderTime <= now) {
                        reminderTime.setDate(reminderTime.getDate() + 1);
                    }
                    
                    const timeUntilReminder = reminderTime.getTime() - now.getTime();
                    
                    const timeoutId = setTimeout(() => {
                        showNotification('HydroTrack - Reminder', {
                            body: 'Time for a glass of water! ðŸ’§',
                            tag: 'water-reminder'
                        });
                        
                        // Set next reminder for tomorrow
                        const nextReminder = new Date();
                        nextReminder.setDate(nextReminder.getDate() + 1);
                        nextReminder.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                        
                        const nextTimeout = setTimeout(() => {
                            showNotification('HydroTrack - Reminder', {
                                body: 'Time for a glass of water! ðŸ’§',
                                tag: 'water-reminder'
                            });
                        }, nextReminder.getTime() - Date.now());
                        
                        reminder.timeoutId = nextTimeout;
                    }, timeUntilReminder);
                    
                    reminder.timeoutId = timeoutId;
                }
            });
        }
        
        function clearNotificationReminders() {
            waterData.reminders.forEach(reminder => {
                if (reminder.intervalId) {
                    clearInterval(reminder.intervalId);
                    delete reminder.intervalId;
                }
                if (reminder.timeoutId) {
                    clearTimeout(reminder.timeoutId);
                    delete reminder.timeoutId;
                }
            });
        }
        
        // Goal modal function
        function setupGoalModal() {
            const goalModal = document.getElementById('goal-modal');
            const closeModal = document.getElementById('close-goal-modal');
            const progressTarget = document.getElementById('progress-target');
            
            // Click handler for hydration goal
            progressTarget.addEventListener('click', function() {
                goalModal.classList.add('active');
                // Set current goal in manual form
                document.getElementById('manual-goal').value = waterData.target;
            });
            
            // Close modal handler
            closeModal.addEventListener('click', function() {
                goalModal.classList.remove('active');
            });
            
            // Close modal when clicking on background
            goalModal.addEventListener('click', function(e) {
                if (e.target === goalModal) {
                    goalModal.classList.remove('active');
                }
            });
            
            // Close modal with ESC key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && goalModal.classList.contains('active')) {
                    goalModal.classList.remove('active');
                }
            });
            
            // Tab switching
            document.querySelectorAll('.goal-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const formType = this.getAttribute('data-form');
                    switchGoalForm(formType);
                });
            });
            
            // Manual goal setting
            document.getElementById('set-manual-goal').addEventListener('click', function() {
                const newGoal = parseInt(document.getElementById('manual-goal').value);
                if (newGoal >= 500 && newGoal <= 5000) {
                    setWaterGoal(newGoal);
                    goalModal.classList.remove('active');
                } else {
                    handleError('Goal must be between 500 and 5000 ml');
                }
            });
            
            // Goal calculation
            document.getElementById('calculate-goal').addEventListener('click', function() {
                calculateWaterGoal();
            });
            
            // Set calculated goal
            document.getElementById('set-calculated-goal').addEventListener('click', function() {
                const calculatedAmount = parseInt(document.getElementById('calculated-amount').textContent);
                setWaterGoal(calculatedAmount);
                goalModal.classList.remove('active');
            });
        }
        
        function switchGoalForm(formType) {
            // Switch tabs
            document.querySelectorAll('.goal-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-form="${formType}"]`).classList.add('active');
            
            // Switch forms
            document.querySelectorAll('.goal-form').forEach(form => {
                form.classList.remove('active');
            });
            document.getElementById(`${formType}-form`).classList.add('active');
        }
        
        function calculateWaterGoal() {
            const weight = parseFloat(document.getElementById('weight').value);
            const age = parseInt(document.getElementById('age').value);
            const activityLevel = document.getElementById('activity-level').value;
            
            if (!weight || !age) {
                handleError('Please enter weight and age');
                return;
            }
            
            // Basic calculation: 35ml per kg of body weight
            let baseAmount = weight * 35;
            
            // Age adjustment
            if (age < 18) {
                baseAmount *= 0.9; // Teens need less water
            } else if (age > 65) {
                baseAmount *= 0.8; // Seniors need less water
            }
            
            // Activity level adjustment
            const activityMultipliers = {
                'low': 1.0,
                'moderate': 1.2,
                'high': 1.5,
                'very-high': 1.8
            };
            
            baseAmount *= activityMultipliers[activityLevel];
            
            // Round to nearest 50ml
            const finalAmount = Math.round(baseAmount / 50) * 50;
            
            // Show result
            document.getElementById('calculated-amount').textContent = `${finalAmount} ml`;
            document.getElementById('calculation-result').style.display = 'block';
            document.getElementById('set-calculated-goal').style.display = 'block';
        }
        
        function setWaterGoal(newGoal) {
            waterData.target = newGoal;
            updateUI();
            saveData();
            showGlobalSuccess(`Hydration goal set to ${newGoal} ml!`);
        }
        
        // FAQ function
        function setupFAQ() {
            const faqQuestions = document.querySelectorAll('.faq-question');
            
            faqQuestions.forEach(question => {
                question.addEventListener('click', function() {
                    const answer = this.nextElementSibling;
                    const icon = this.querySelector('i');
                    
                    // Close all other FAQs
                    faqQuestions.forEach(otherQuestion => {
                        if (otherQuestion !== this) {
                            otherQuestion.classList.remove('active');
                            otherQuestion.nextElementSibling.classList.remove('active');
                        }
                    });
                    
                    // Toggle current FAQ
                    this.classList.toggle('active');
                    answer.classList.toggle('active');
                });
            });
        }
    </script>
</body>
</html>